/**
 * photoset-grid - v1.0.2
 * 2015-02-12
 * jQuery plugin to arrange images into a flexible grid
 * http://stylehatch.github.com/photoset-grid/
 * Some modifications not fully tested by Edmundo Junior, please use the original one
 * Copyright 2014 Jonathan Moore - Style Hatch
 */
!function(t,i,e,s){"use strict";function o(i,e){this.element=i,this.options=t.extend({},a,e),this._defaults=a,this._name=n,this.init()}var n="photosetGrid",a={highresLinks:!1,lowresWidth:500,rel:"",onInit:function(){},onComplete:function(){}};o.prototype={init:function(){this.options.onInit(),this._setupRows(this.element,this.options),this._setupColumns(this.element,this.options)},_callback:function(t){this.options.onComplete(t)},_setupRows:function(i,e){if(e.layout)this.layout=e.layout;else if(t(i).attr("data-layout"))this.layout=t(i).attr("data-layout");else{for(var s="",o=1,n=0;n<t(i).find("img").length;n++)s+=o.toString();this.layout=s}this.rows=this.layout.split("");for(var a in this.rows)this.rows[a]=parseInt(this.rows[a],10);var h=t(i).find("img"),r=0;t.each(this.rows,function(t,i){var e=r,s=r+i;h.slice(e,s).wrapAll('<div class="photoset-row photoset-cols-'+i+'"></div>'),r=s})},_setupColumns:function(e,s){var o=this,n=function(o){function n(){var i=t(e).width().toString();i!==t(e).attr("data-width")&&(a.each(function(){var i=t(this).find("img:eq(0)");t(this).find("img").each(function(){var e=t(this);e.attr("height")<i.attr("height")&&(i=t(this)),parseInt(e.css("width"),10)>s.lowresWidth&&e.attr("data-highres")&&e.attr("src",e.attr("data-highres"))})}),t(e).attr("data-width",i))}var a=t(e).find(".photoset-row"),h=t(e).find("img");s.highresLinks?(h.each(function(){var i;i=t(this).attr(t(this).attr("data-highres")?"data-highres":"src"),t(this).wrapAll('<a href="'+i+'" class="photoset-cell highres-link" />')}),s.rel&&h.parent().attr("rel",s.rel)):h.each(function(){t(this).wrapAll('<div class="photoset-cell" />')});var r=(t(e).find(".photoset-cell"),t(e).find(".photoset-cols-1 .photoset-cell")),l=t(e).find(".photoset-cols-2 .photoset-cell"),c=t(e).find(".photoset-cols-3 .photoset-cell"),d=t(e).find(".photoset-cols-4 .photoset-cell"),u=t(e).find(".photoset-cols-5 .photoset-cell");o&&h.each(function(){t(this).attr("height",t(this).height()),t(this).attr("width",t(this).width())}),r.css({width:"100%"}),l.css({width:"50%"}),c.css({width:"33.333333333%"}),d.css({width:"25%"}),u.css({width:"20%"}),n(),t(i).on("resize",function(){n()})},a=!0,h=!0;t(e).find("img").each(function(){h&=!!t(this).attr("height")&!!t(this).attr("width")}),a=!h,a?t(e).imagesLoaded(function(){n(a),o._callback(e)}):(n(a),o._callback(e))}},t.fn[n]=function(i){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new o(this,i))})};var h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";t.fn.imagesLoaded=function(i){function e(){var e=t(u),s=t(f);r&&(f.length?r.reject(c,e,s):r.resolve(c)),t.isFunction(i)&&i.call(a,c,e,s)}function o(t){n(t.target,"error"===t.type)}function n(i,s){i.src!==h&&-1===t.inArray(i,d)&&(d.push(i),s?f.push(i):u.push(i),t.data(i,"imagesLoaded",{isBroken:s,src:i.src}),l&&r.notifyWith(t(i),[s,c,t(u),t(f)]),c.length===d.length&&(setTimeout(e),c.unbind(".imagesLoaded",o)))}var a=this,r=t.isFunction(t.Deferred)?t.Deferred():0,l=t.isFunction(r.notify),c=a.find("img").add(a.filter("img")),d=[],u=[],f=[];return t.isPlainObject(i)&&t.each(i,function(t,e){"callback"===t?i=e:r&&r[t](e)}),c.length?c.bind("load.imagesLoaded error.imagesLoaded",o).each(function(i,e){var o=e.src,a=t.data(e,"imagesLoaded");return a&&a.src===o?void n(e,a.isBroken):e.complete&&e.naturalWidth!==s?void n(e,0===e.naturalWidth||0===e.naturalHeight):void((e.readyState||e.complete)&&(e.src=h,e.src=o))}):e(),r?r.promise(a):a};var r,l,c,d=t.event,u={_:0},f=0;r=d.special.throttledresize={setup:function(){t(this).on("resize",r.handler)},teardown:function(){t(this).off("resize",r.handler)},handler:function(i,e){var s=this,o=arguments;l=!0,c||(setInterval(function(){f++,(f>r.threshold&&l||e)&&(i.type="throttledresize",d.dispatch.apply(s,o),l=!1,f=0),f>9&&(t(u).stop(),c=!1,f=0)},30),c=!0)},threshold:0}}(jQuery,window,document);